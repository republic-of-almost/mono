#!lua

--[[
  SoLoud Project Description
]]--

table.insert(
  projects,
  {
    name            = "SoLoud",
    kind            = "StaticLib",
    language        = "C++",
    location        = make.get_proj_root(),
    ignore_defaults = true,

    src_files = {
      make.add_headers(make.get_proj_root() .. "../include/"),
      --
      make.add_src(make.get_proj_root() .. "../src/audiosource/"),
      make.add_src(make.get_proj_root() .. "../src/core/"),
      make.add_src(make.get_proj_root() .. "../src/filter/"),
    },

    src_files_exclude = {
      make.get_proj_root() .. "../src/audiosource/openmpt/soloud_openmpt_dll.c",
    },

    public_inc_dirs = {
      make.get_proj_root() .. "../include",
      make.get_proj_root() .. "../include/soloud/",
    },

    -- macOS Setup --

    src_files_macosx = {
      make.add_src(make.get_proj_root() .. "../src/backend/coreaudio"),
    },

    defines_macosx = {
      "WITH_COREAUDIO=1",
    },

    link_dependencies_macosx = {
      "AudioToolbox.framework",
      "pthread",
    },

    -- Linux Setup --

    src_files_linux = {
      make.add_src(make.get_proj_root() .. "../src/backend/oss"),
      make.add_src(make.get_proj_root() .. "../src/backend/alsa"),
    },

    defines_linux = {
      "WITH_ALSA=1",
      "WITH_OSS=1",
    },

    link_dependencies_linux = {
      "asound",
      "pthread",
    },

    -- Windows Setup --

    src_files_windows = {
      make.add_src(make.get_proj_root() .. "../src/backend/winmm"),
    },

    defines_windows = {
      "WITH_WINMM=1",
    },
  }
)
